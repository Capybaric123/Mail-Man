<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mining Game</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #game { max-width: 600px; margin: auto; }
        #money, #timer { font-size: 24px; }
        button { margin: 5px; }
        #oreList { margin-top: 20px; }
        #counters { margin-top: 20px; }
    </style>
</head>
<body>
    <div id="game">
        <div id="money">Money: $1000</div>
        <div id="timer">Time: 0s</div>
        <div>
            <button id="buyDrill">Buy Drill (50$)</button>
            <button id="upgradeDrill">Upgrade Drills (100$)</button>
            <button id="buyCooler">Buy Cooler (200$)</button>
            <button id="autoSell">Toggle Auto Sell</button>
        </div>
        <div id="oreList"></div>
        <div id="counters">Miners: 0 | Upgrades: 0 | Coolers: 0</div>
    </div>

    <script>
        let money = 1000;
        let drills = 0;
        let coolerCount = 0;
        let upgrades = 0;
        let drillCooldown = 1000; // milliseconds
        let timer = 0;
        let interval;
        let autoSell = false;

        const ores = {
            stone: { price: 5, amount: 0 },
            coal: { price: 10, amount: 0 },
            iron: { price: 15, amount: 0 },
            magma: { price: 20, amount: 0 },
            diamond: { price: 100, amount: 0 },
            emerald: { price: 500, amount: 0 },
            lazuli: { price: 1000, amount: 0 },
            ruby: { price: 10000, amount: 0 },
        };

        // Function to save the game state to localStorage
        function saveGame() {
            const gameState = {
                money,
                drills,
                coolerCount,
                upgrades,
                drillCooldown,
                timer,
                autoSell,
                ores
            };
            localStorage.setItem('miningGameSave', JSON.stringify(gameState));
        }

        // Function to load the game state from localStorage
        function loadGame() {
            const savedGame = localStorage.getItem('miningGameSave');
            if (savedGame) {
                const gameState = JSON.parse(savedGame);
                money = gameState.money;
                drills = gameState.drills;
                coolerCount = gameState.coolerCount;
                upgrades = gameState.upgrades;
                drillCooldown = gameState.drillCooldown;
                timer = gameState.timer;
                autoSell = gameState.autoSell;
                Object.assign(ores, gameState.ores);  // Restore ore amounts
                updateDisplay();
            }
        }

        function updateDisplay() {
            document.getElementById('money').innerText = `Money: $${money}`;
            document.getElementById('timer').innerText = `Time: ${timer}s`;
            document.getElementById('counters').innerText = `Miners: ${drills} | Upgrades: ${upgrades} | Coolers: ${coolerCount}`;
            document.getElementById('oreList').innerHTML = Object.entries(ores)
                .map(([ore, data]) => `${ore.charAt(0).toUpperCase() + ore.slice(1)}: $${data.price} for 10 | Amount: ${data.amount}`)
                .join('<br>');
        }

        function mine() {
            if (drills > 0) {
                for (let i = 0; i < drills; i++) {
                    let roll = Math.random();
                    if (roll < 0.0001) ores.ruby.amount += 10;
                    else if (roll < 0.001) ores.lazuli.amount += 10;
                    else if (roll < 0.01) ores.emerald.amount += 10;
                    else if (roll < 0.1) ores.diamond.amount += 10;
                    else if (roll < 0.3) ores.magma.amount += 10;
                    else if (roll < 0.6) ores.iron.amount += 10;
                    else if (roll < 0.9) ores.coal.amount += 10;
                    else ores.stone.amount += 10;
                }
                if (autoSell) {
                    sellAllOres();
                }
            }
            updateDisplay();
        }

        function sellOre(ore) {
            if (ores[ore].amount >= 10) {
                ores[ore].amount -= 10;
                money += ores[ore].price;
                updateDisplay();
            }
        }

        function sellAllOres() {
            for (const ore of Object.keys(ores)) {
                while (ores[ore].amount >= 10) {
                    ores[ore].amount -= 10;
                    money += ores[ore].price;
                }
            }
            updateDisplay();
        }

        function startTimer() {
            setInterval(() => {
                timer++;
                updateDisplay();
            }, 1000);
        }

        document.getElementById('buyDrill').onclick = () => {
            if (money >= 50) {
                drills++;
                money -= 50;
                updateDisplay();
            }
        };

        document.getElementById('upgradeDrill').onclick = () => {
            if (money >= 100) {
                drillCooldown = Math.max(800, drillCooldown - 200);
                money -= 100;
                upgrades++;
                updateDisplay();
            }
        };

        document.getElementById('buyCooler').onclick = () => {
            if (money >= 200) {
                coolerCount++;
                drillCooldown = Math.max(800, drillCooldown - 200);
                money -= 200;
                updateDisplay();
            }
        };

        document.getElementById('autoSell').onclick = () => {
            autoSell = !autoSell;
            document.getElementById('autoSell').innerText = autoSell ? "Disable Auto Sell" : "Enable Auto Sell";
        };

        for (const ore of Object.keys(ores)) {
            const button = document.createElement('button');
            button.innerText = `Sell 10 ${ore.charAt(0).toUpperCase() + ore.slice(1)}`;
            button.onclick = () => sellOre(ore);
            document.getElementById('oreList').appendChild(button);
        }

        // Auto-save every second
        setInterval(saveGame, 1000);

        // Load the game state on startup
        loadGame();

        startTimer();
        setInterval(mine, drillCooldown);
        updateDisplay();
    </script>
</body>
</html>
